Backbone.StateRouter=Backbone.Router.extend({constructor:function(a){Backbone.Router.prototype.constructor.call(this,a),this.manager=a.manager,this._stateRoutes={};if(this.manager){var b=this;this.manager.sub("stay",function(a){var c=b._stateRoutes[a];c&&b.navigate(c)}),this.on("all",function(a){var b=/^route:state:(.+)/.exec(a);b&&this.manager.go(b[1])})}},route:function(a,b){Backbone.Router.prototype.route.apply(this,arguments);var c=/^state:(.+)/.exec(b);c&&(this._stateRoutes[c[1]]=a)}});